{"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/swiftql\/generictableparameters"]}],"primaryContentSections":[{"content":[{"anchor":"Overview","level":2,"text":"Overview","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"SwiftQL lets you create "},{"type":"codeVoice","code":"@SQLTable"},{"type":"text","text":" and "},{"type":"codeVoice","code":"SQLResult"},{"type":"text","text":" definitions which use"},{"type":"text","text":" "},{"type":"text","text":"generic type parameters. Generic parameters can use the intrinsic types"},{"type":"text","text":" "},{"type":"text","text":"including "},{"type":"codeVoice","code":"Bool"},{"type":"text","text":", "},{"type":"codeVoice","code":"Int"},{"text":", ","type":"text"},{"code":"Double","type":"codeVoice"},{"type":"text","text":", "},{"code":"String","type":"codeVoice"},{"text":" and ","type":"text"},{"code":"Data","type":"codeVoice"},{"text":", as well any custom type","type":"text"},{"text":" ","type":"text"},{"text":"defined as an ","type":"text"},{"type":"codeVoice","code":"SQLCustomType"},{"type":"text","text":"."}]},{"inlineContent":[{"type":"text","text":"A table or result with generic parameters might be used where the structure of"},{"type":"text","text":" "},{"type":"text","text":"the table or result is commonly used in an application, but where the type of"},{"type":"text","text":" "},{"type":"text","text":"some or all of the fields differs."}],"type":"paragraph"},{"type":"heading","level":2,"text":"Using generic tables","anchor":"Using-generic-tables"},{"type":"paragraph","inlineContent":[{"text":"We define a table with a generic parameter conforming to ","type":"text"},{"code":"XLLiteral","type":"codeVoice"},{"text":" and","type":"text"},{"text":" ","type":"text"},{"code":"XLExpression","type":"codeVoice"},{"text":". SwiftQL does impose a limit on the number or type of generic","type":"text"},{"text":" ","type":"text"},{"text":"parameters.","type":"text"}]},{"type":"codeListing","code":["@SQLTable struct GenericTable<Value: XLLiteral & XLExpression> {","    var id: String","    var type: String","    var value: Value","}"],"syntax":"swift"},{"inlineContent":[{"type":"text","text":"We can now use our generic table like any other table create, insert, and query"},{"type":"text","text":" "},{"type":"text","text":"our table using a "},{"type":"codeVoice","code":"String"},{"text":" generic parameter.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"First we create the table. The generic parameter used in the create statement"},{"text":" ","type":"text"},{"text":"is not important as it can be overridden in queries.","type":"text"}]},{"syntax":"swift","code":["let createStatement = sqlCreate(GenericTable<String>.self)","try database.makeRequest(with: createStatement).execute()"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"Next we can insert some data into the table. Here the generic type is inferred","type":"text"},{"type":"text","text":" "},{"type":"text","text":"to be "},{"code":"String","type":"codeVoice"},{"type":"text","text":" from the value assigned to the "},{"type":"codeVoice","code":"value"},{"type":"text","text":" attribute."}]},{"code":["let insertStatement = sqlInsert(GenericTable(id: \"foo-name\", type: \"name\", value: \"Foo\"))","try database.makeRequest(with: insertStatement).execute()"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"We can now use the generic table in a "},{"type":"codeVoice","code":"Select"},{"text":" query. We need to provide the","type":"text"},{"type":"text","text":" "},{"type":"text","text":"generic parameter in the query when specifying the table."}]},{"type":"codeListing","syntax":"swift","code":["let selectStatement = sql { schema in","    let table = schema.table(GenericTable<String>.self)","    Select(table)","    From(table)","    Where(table.type == \"name\")","}","let names = try database.makeRequest(with: selectStatement).fetchAll()"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"We can use the same table with an "},{"type":"codeVoice","code":"Int"},{"text":" parameter. We can insert another record","type":"text"},{"type":"text","text":" "},{"text":"into the table with an integer value:","type":"text"}]},{"type":"codeListing","code":["let insertStatement = sqlInsert(GenericTable(id: \"foo-age\", type: \"age\", value: 42))","try database.makeRequest(with: insertStatement).execute()"],"syntax":"swift"},{"inlineContent":[{"text":"We can select our integer records from the database:","type":"text"}],"type":"paragraph"},{"code":["let selectStatement = sql { schema in","    let table = schema.table(GenericTable<Int>.self)","    Select(table)","    From(table)","    Where(table.type == \"age\")","}","let ages = try database.makeRequest(with: selectStatement).fetchAll()"],"type":"codeListing","syntax":"swift"},{"anchor":"Custom-types","level":2,"text":"Custom types","type":"heading"},{"inlineContent":[{"type":"text","text":"Generic tables can also use custom types which we define. Let’s look at an"},{"text":" ","type":"text"},{"type":"text","text":"example using the custom UUID shown in "},{"isActive":true,"type":"reference","identifier":"doc:\/\/SwiftQL\/documentation\/SwiftQL\/CustomTypes#Custom-UUID"},{"text":". Our custom","type":"text"},{"type":"text","text":" "},{"type":"text","text":"type is used just like an intrinsic type:"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"We can create a table using out custom type:"}],"type":"paragraph"},{"code":["let createStatement = sqlCreate(GenericTable<MyUUID>.self)","try database.makeRequest(with: createStatement).execute()"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"We can insert records using those values:"}],"type":"paragraph"},{"code":["let uuid = MyUUID(UUID(uuidString: \"72472fdd-a897-4b35-9bd9-0f23688f45f7\")!)","let insertStatement = sqlInsert(GenericTable(id: \"foo-id\", type: \"id\", value: uuid))","try database.makeRequest(with: insertStatement).execute()"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"We can query our generic table using our custom type:"}],"type":"paragraph"},{"code":["let selectStatement = sql { schema in","    let table = schema.table(GenericTable<MyUUID>.self)","    Select(table)","    From(table)","    Where(table.type == \"id\")","}","let uuids = try database.makeRequest(with: selectStatement).fetchAll()"],"type":"codeListing","syntax":"swift"},{"text":"Data consistency","type":"heading","level":2,"anchor":"Data-consistency"},{"inlineContent":[{"type":"text","text":"Generic tables take advantage of SQLite’s loose typing or type affinity: that is"},{"type":"text","text":" "},{"type":"text","text":"the type of a table column is not strictly enforced. This comes with the caveat"},{"type":"text","text":" "},{"type":"text","text":"that a column in a table can potentially contain different types of data."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Consider the use case described above where a generic table contains both "},{"type":"codeVoice","code":"Int"},{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"and  "},{"type":"codeVoice","code":"String"},{"type":"text","text":" data:"}],"type":"paragraph"},{"code":["let fooName = GenericTable(id: \"foo-name\", type: \"name\", value: \"Foo\")","try database.makeRequest(with: sqlInsert(fooName).execute()","","let fooAge = GenericTable(id: \"foo-age\", type: \"age\", value: 42)","try database.makeRequest(with: sqlInsert(fooAge)).execute()"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"Our table now contains two records. One record contains a "},{"type":"codeVoice","code":"String"},{"type":"text","text":" "},{"type":"codeVoice","code":"\"foo\""},{"type":"text","text":", and"},{"type":"text","text":" "},{"type":"text","text":"the other record contains an "},{"type":"codeVoice","code":"Int"},{"type":"text","text":" "},{"type":"codeVoice","code":"42"},{"type":"text","text":". If we now select from the table using"},{"type":"text","text":" "},{"type":"text","text":"an "},{"type":"codeVoice","code":"Int"},{"type":"text","text":" for the generic table, without an appropriate "},{"type":"codeVoice","code":"Where"},{"type":"text","text":" clause, the"},{"type":"text","text":" "},{"type":"text","text":"query will select rows containing "},{"type":"codeVoice","code":"String"},{"type":"text","text":" and "},{"type":"codeVoice","code":"Int"},{"type":"text","text":" values, resulting in an"},{"type":"text","text":" "},{"type":"text","text":"exception at runtime."}],"type":"paragraph"},{"code":["let selectStatement = sql { schema in","    let table = schema.table(GenericTable<Int>.self)","    Select(table)","    From(table)","}"],"type":"codeListing","syntax":"swift"},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"It is the programmer’s responsibility to ensure that generic tables"},{"type":"text","text":" "},{"type":"text","text":"are read and written in a consistent manner."}]}],"type":"aside","name":"Warning","style":"warning"}],"kind":"content"}],"metadata":{"modules":[{"name":"SwiftQL"}],"title":"Generic Table Parameters","roleHeading":"Article","role":"article"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/SwiftQL\/documentation\/SwiftQL\/GenericTableParameters"},"seeAlsoSections":[{"generated":true,"title":"Advanced topics","identifiers":["doc:\/\/SwiftQL\/documentation\/SwiftQL\/CustomFunctions","doc:\/\/SwiftQL\/documentation\/SwiftQL\/CustomTypes"],"anchor":"Advanced-topics"}],"abstract":[{"type":"text","text":"Use generic parameters on table definitions."}],"hierarchy":{"paths":[["doc:\/\/SwiftQL\/documentation\/SwiftQL"]]},"sections":[],"schemaVersion":{"major":0,"patch":0,"minor":3},"kind":"article","references":{"doc://SwiftQL/documentation/SwiftQL/CustomTypes":{"role":"article","identifier":"doc:\/\/SwiftQL\/documentation\/SwiftQL\/CustomTypes","url":"\/documentation\/swiftql\/customtypes","abstract":[{"type":"text","text":"Create custom scalar types for table columns."}],"title":"Custom Types","kind":"article","type":"topic"},"doc://SwiftQL/documentation/SwiftQL":{"abstract":[{"type":"text","text":"Write SQL using familiar type-safe Swift syntax."}],"title":"SwiftQL","type":"topic","identifier":"doc:\/\/SwiftQL\/documentation\/SwiftQL","role":"collection","url":"\/documentation\/swiftql","kind":"symbol"},"doc://SwiftQL/documentation/SwiftQL/CustomTypes#Custom-UUID":{"title":"Custom UUID","kind":"section","type":"topic","identifier":"doc:\/\/SwiftQL\/documentation\/SwiftQL\/CustomTypes#Custom-UUID","url":"\/documentation\/swiftql\/customtypes#Custom-UUID","abstract":[]},"doc://SwiftQL/documentation/SwiftQL/CustomFunctions":{"role":"article","identifier":"doc:\/\/SwiftQL\/documentation\/SwiftQL\/CustomFunctions","url":"\/documentation\/swiftql\/customfunctions","abstract":[{"type":"text","text":"Create custom functions that can be called from SQL expressions."}],"title":"Custom Functions","kind":"article","type":"topic"}}}